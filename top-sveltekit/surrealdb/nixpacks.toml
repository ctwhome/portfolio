[phases.setup]
nixPkgs = [
    'bun',
    'gcc',
    'glib',
    'pkg-config',
    'vips',
    'stdenv'
]

[phases.install]
cmds = [
    'apt-get update && apt-get install -y libstdc++6',
    'bun install --include=optional',
    'bun add sharp@latest --platform=linux --arch=arm64'
]

[phases.build]
cmds = ['bun run build']

[start]
cmd = "bun run start"
